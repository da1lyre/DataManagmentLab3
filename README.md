# УД Лабораторная работа 3

## Описание схемы БД
БД представлена 4-мя таблицами:

#### _**САДОВОД**_
| ИДЕНТИФИКАТОР | ФАМИЛИЯ | ТОВАРИЩЕСТВО | ЛЬГОТА,% |
|---------------|---------|--------------|----------|

#### _**ПИТОМНИК**_
| ИДЕНТИФИКАТОР | НАЗВАНИЕ | ТОВАРИЩЕСТВО | КОМИССИОННЫЕ,% |
|---------------|----------|--------------|----------------|

#### _**РАСТЕНИЯ**_
| ИДЕНТИФИКАТОР | СОРТ | ОТКУДА | ЦЕНА, РУБ | КОЛ-ВО САЖЕНЦЕВ |
|---------------|------|--------|-----------|-----------------|

#### _**ПОКУПКА**_
| НОМЕР ВЕДОМОСТИ | ДАТА | САДОВОД | ПИТОМНИК | РАСТЕНИЕ | КОЛ-ВО | ИТОГОВАЯ СТОИМОСТЬ, РУБ |
|-----------------|------|---------|----------|----------|--------|-------------------------|
--- 
#### ER-диаграмма:

<img width="703" height="634" alt="изображение" src="https://github.com/user-attachments/assets/effd9a12-2798-45b6-aba0-345a4e2f9d1d"/>

## Задания и решения

## Уровень 1
### Задание 1.

##### Формулировка:
Дана схема базы данных в виде следующих отношений.  С помощью операторов SQL создать логическую структуру соответствующих таблиц для хранения в СУБД, используя известные средства поддержания целостности (NOT NULL, UNIQUE, и т.д.). Обосновать выбор типов данных и используемые средства поддержания целостности. При выборе подходящих типов данных использовать информацию о конкретных значениях полей БД (см. прил.1)
##### Решение:
[SQL код](./Level1/task1.sql)
##### Результат:

---

### Задание 2.

##### Формулировка:
Ввести в ранее созданные таблицы конкретные данные (см. прил. 1). Использовать скрипт-файл из операторов INSERT или вспомогательную утилиту.

##### Решение:
[SQL код](./Level1/task2.sql)

##### Результат:

---

### Задание 3.

##### Формулировка:
Используя оператор SELECT создать запрос для вывода всех строк каждой таблицы. Проверить правильность ввода. При необходимости произвести коррекцию значений операторами INSERT, UPDATE, DELETE. 

##### Решение:
[SQL код](./Level1/task3.sql)

##### Результат:

---

### Задание 4.

##### Формулировка:
Создать запросы для вывода:
- всех различных названий товариществ;
- всех различных товариществ, откуда были получены в питомник растения;
- всех различных месяцы, когда производились покупки.

##### Решение:
[SQL код](./Level1/task4.sql)

##### Результат:

---

### Задание 5.

##### Формулировка:
Создать запросы для получения информации о:
- фамилиях и размере льгот всех садоводов из товарищества “Урожай”;
- фамилиях садоводов из товарищества “Радостное” или “Дальнее”;
- названиях  и стоимости растений,  которые покупались в питомниках товарищества “Мичуринское” или стоящих более 30000 руб..

##### Решение:
[SQL код](./Level1/task5.sql)

##### Результат:

---

### Задание 6.

##### Формулировка:
Для каждой покупки вывести следующие данные:
- фамилию садовода и название питомника, где производилась покупка;
- дату, фамилию садовода, льготу, название и количество купленных растений.
[SQL код](./Level1/task6.sql)

##### Решение:

##### Результат:

---

### Задание 7.

##### Формулировка:
Определить:
- номер ведомости, фамилию садовода и дату покупки в которой было куплено растений на сумму не меньшую чем 60000 руб.
- покупки, сделанные садоводом в питомниках своего товарищества не ранее марта месяца. Вывести фамилию, товарищество, дату. Произвести сортировку;
- питомники, расположенные в любом товариществе, кроме “Дальнего”, где покупали растения те, у кого льгота от 1 до 2 %;
- данные по покупке растений (название, питомник, купленное количество), приобретенных садоводами из того же товарищества, которое первоначально предоставило эти растения в питомник. Включить данные об итоговой стоимости и отсортировать по возрастанию. 

##### Решение:
[SQL код](./Level1/task7.sql)

##### Результат:

---
### Задание 8.

##### Формулировка:
Создать запрос для модификации всех значений столбца с суммарной величиной покупки, чтобы он содержал истинную сумму, оплачиваемую садоводом ( с учетом льгот). Вывести новые значения.

##### Решение:
[SQL код](./Level1/task8.sql)

##### Результат:

---

### Задание 9.

##### Формулировка:
Расширить таблицу с данными о покупке столбцом, содержащим величину коммисионных, получаемых питомником. Создать запрос для ввода конкретных значений во все строки таблицы покупок.

##### Решение:
[SQL код](./Level1/task9.sql)

##### Результат:

---

## Уровень 2
### Задание 10.

##### Формулировка:
Используя операцию IN (NOT IN)  реализовать следующие запросы:
- запросы из задания 7.b, 7d;
- фамилии садоводов, которые не покупали растений в питомниках товарищества “Мичуринское”;
- фамилии садоводов, покупавших вишни.

##### Решение:
[SQL код](./Level2/task10.sql)

##### Результат:

---

### Задание 11.

##### Формулировка:
Используя операции ALL-ANY реализовать следующие запросы:
- Названия растений, продающихся в питомниках “Дальнего” и имеющих наибольшую стоимость;
- фамилии садоводов имеющих льготы больше минимальных;
- названия питомников всех товариществ, кроме “Урожай”, для которых среди питомников товарищества “Урожай” есть такие, которые имеют такой же размер комиссионных;
- запрос задания 7.а.

##### Решение:
[SQL код](./Level2/task11.sql)

##### Результат:

---

### Задание 12.

##### Формулировка:
Используя операцию UNION получить названия товариществ, где трудятся садоводы или расположены питомники.

##### Решение:
[SQL код](./Level2/task12.sql)

##### Результат:

---

### Задание 13.

##### Формулировка:
Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. В случае, если для текущего состояния БД запрос будет выдавать пустое множество строк, требуется указать какие добавления в БД необходимо провести.
- найти садоводов, покупавших все растения товарищества “Солнечное” не позднее июня;
- найти растения, которые покупали все садоводы с размером льгот менее 3% из питомников товарищества “Урожай”;
- найти такие питомники, которые продавали растения всем садоводам со льготами;
- найти садоводов с размером льгот больше минимального, которые покупали растения во всех питомниках.

##### Решение:
[SQL код](./Level2/task13.sql)

##### Результат:

---

### Задание 14.

##### Формулировка:
Реализовать запросы с использованием аггрегатных функций:
- определить количество различных растений, купленных садоводоами из дальнего в мае и июне;
- определить на какую суммарную стоимость было продано саженцев вишни;
- какие садоводы делали покупки на сумму выше средней;
- какие питомники продавали растения всем садоводам со льготами меньше средних.

##### Решение:
[SQL код](./Level2/task14.sql)
 
##### Результат:

---

### Задание 15.

##### Формулировка:
Используя средства группировки реализовать следующие запросы:
- для каждого растения определить общее число различных покупателей;
- найти те месяца, когда из питомников Даьнего покупали растений на общую сумму более 700000;
- для каждой пары “садовод-растение” определить общее количество купленных саженцев;
- какие садоводы приобрели саженцев крыжовника на общую сумму более 300000.

##### Решение:
[SQL код](./Level2/task15.sql)

##### Результат:
